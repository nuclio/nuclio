
<!DOCTYPE html>

<html lang="go">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>How to Contribute to Nuclio &#8212; nuclio 1.12.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="how-to-contribute-to-nuclio">
<h1>How to Contribute to Nuclio<a class="headerlink" href="#how-to-contribute-to-nuclio" title="Permalink to this heading">¶</a></h1>
<p>This guide will guide you through the process of setting up a development environment and contributing to Nuclio.</p>
<section id="in-this-document">
<h2>In This Document<a class="headerlink" href="#in-this-document" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><span class="xref myst">Prerequisites</span></p></li>
<li><p><span class="xref myst">Getting the source code</span></p></li>
<li><p><span class="xref myst">Setting up a GoLand project</span></p></li>
<li><p><span class="xref myst">Submitting a PR</span></p></li>
</ul>
<p><a id="prerequisites"></a></p>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">¶</a></h2>
<p>Ensure that your setup includes the following prerequisite components:</p>
<ul class="simple">
<li><p>Linux or OSX</p></li>
<li><p>Git</p></li>
<li><p>Docker version 19.03+</p></li>
<li><p>The Go toolchain (CI tests with 1.21, best use that)</p></li>
<li><p>Kubernetes version 1.24+ (mostly for testing) - <code class="docutils literal notranslate"><span class="pre">minikube</span></code> recommended; (you can follow
the <a class="reference internal" href="../setup/minikube/getting-started-minikube.html"><span class="doc std std-doc">Minikube getting-started guide</span></a>)</p></li>
</ul>
<p><a id="get-source"></a></p>
</section>
<section id="getting-the-source-code">
<h2>Getting the source code<a class="headerlink" href="#getting-the-source-code" title="Permalink to this heading">¶</a></h2>
<p>Fork the Nuclio GitHub repository and clone it:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/&lt;your<span class="w"> </span>username&gt;/nuclio.git<span class="w"> </span>~/nuclio
</pre></div>
</div>
<p>Check out the <code class="docutils literal notranslate"><span class="pre">development</span></code> branch, because that's where all the goodness happens:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/nuclio<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>development
</pre></div>
</div>
<p>Now, use <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">modules</span></code> to get Nuclio's dependencies and modules</p>
<p>Build Nuclio artifacts (<code class="docutils literal notranslate"><span class="pre">nuctl</span></code>, container images):</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>build
</pre></div>
</div>
<p>You should now have quite a few <code class="docutils literal notranslate"><span class="pre">nuclio/&lt;something&gt;</span></code> images tagged as <code class="docutils literal notranslate"><span class="pre">latest-amd64</span></code>, along
with <code class="docutils literal notranslate"><span class="pre">nuctl-latest-&lt;os&gt;-amd64</span></code> with a <code class="docutils literal notranslate"><span class="pre">nuctl</span></code> symbolic link under <code class="docutils literal notranslate"><span class="pre">$GOPATH/bin</span></code>.</p>
<blockquote>
<div><p>Note: to make nuclio container images available for arm64 architecture run <code class="docutils literal notranslate"><span class="pre">NUCLIO_ARCH=arm64</span> <span class="pre">make</span> <span class="pre">build</span></code></p>
</div></blockquote>
<p>Now, run a few unit tests:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>lint<span class="w"> </span>test-unit
</pre></div>
</div>
<p>This is a short test suite, and requires only Docker.</p>
<p>Note: Writing (Go) Nuclio tests requiring it having build tag annotation at the first line Use the following build tag
annotations to match the test purpose:</p>
<ul class="simple">
<li><p>test_unit - unit testings</p></li>
<li><p>test_integration - integration testings</p></li>
<li><p>test_functional - functional testings</p></li>
<li><p>test_kube - requires kubernetes platform</p></li>
<li><p>test_local - requires docker platform</p></li>
<li><p>test_iguazio - requires Iguazio system</p></li>
<li><p>test_broken - test suite is broken, cannot be executed on CI</p></li>
</ul>
<p>To run Kubernetes <code class="docutils literal notranslate"><span class="pre">nuctl</span></code> suite locally:</p>
<p><code class="docutils literal notranslate"><span class="pre">NUCTL_REGISTRY=&lt;registry&gt;</span> <span class="pre">make</span> <span class="pre">test-k8s-nuctl</span></code></p>
<p>To run Docker <code class="docutils literal notranslate"><span class="pre">nuctl</span></code> suite locally:</p>
<p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test-docker-nuctl</span></code></p>
<p>To run Kubernetes platform integration test locally:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Installing nuclio CRDs</span>
sh<span class="w"> </span>test/k8s/ci_assets/install_nuclio_crds.sh

<span class="c1"># Running local Docker registry</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>registry:2

make<span class="w"> </span>test-k8s
</pre></div>
</div>
<p>To run integration tests for docker platform, run:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
<blockquote>
<div><p>Note: it may take a while ~90 minutes</p>
</div></blockquote>
<p>On Nuclio CI, we run nuctl test suites against both Docker and Kubernetes platforms.</p>
<p>Running more comprehensive end-to-end tests on kubernetes is currently done manually.</p>
<p>When you're done, create a feature branch from the <code class="docutils literal notranslate"><span class="pre">development</span></code> branch; (Nuclio follows the GitFlow branching model):</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>my-feature
</pre></div>
</div>
<p><a id="goland-setup"></a></p>
</section>
<section id="setting-up-a-goland-project">
<h2>Setting up a GoLand project<a class="headerlink" href="#setting-up-a-goland-project" title="Permalink to this heading">¶</a></h2>
<p>The Nuclio team is a fan of GoLand and uses it heavily for Go projects. It was decided not to include the <strong>.idea</strong>
files at this time, but it's very easy to create run/debug targets and use the debugger</p>
<ol class="arabic simple">
<li><p>Clone nuclio <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">git&#64;github.com:nuclio/nuclio.git</span> <span class="pre">&gt;</span> <span class="pre">~/nuclio</span></code></p></li>
<li><p>Open GoLand and <strong>File &gt; Open</strong> and select <code class="docutils literal notranslate"><span class="pre">~/nuclio</span></code></p></li>
<li><p>Enable go modules <strong>GoLand &gt; Preferences &gt; Go &gt; Go Modules (vgo)</strong> and ensure <code class="docutils literal notranslate"><span class="pre">Enable</span> <span class="pre">Go</span> <span class="pre">Modules</span></code> box is checked</p></li>
<li><p>Run configurations are (currently) available for tests only</p></li>
</ol>
<p>For developing in nuclio locally, see <span class="xref myst">Local development</span>.</p>
<p><a id="goland-versioning-note"></a></p>
<section id="versioning-note">
<h3>Versioning note<a class="headerlink" href="#versioning-note" title="Permalink to this heading">¶</a></h3>
<p>All Nuclio artifacts are versioned. They take their versions from variables in <strong>v3io/version-go/version.go</strong>.</p>
<p>During link time, the linker set the version variables using the <code class="docutils literal notranslate"><span class="pre">-X</span></code> flag.</p>
<p>Since there is an auto-fallback to &quot;latest&quot;, if you want to use versioned binaries, make sure to pass the following as
part of the <code class="docutils literal notranslate"><span class="pre">Go</span> <span class="pre">tool</span> <span class="pre">arguments</span></code> in the Run/Debug configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ldflags</span><span class="o">=</span><span class="s2">&quot;-X github.com/v3io/version-go.label=1.7.2&quot;</span>
</pre></div>
</div>
<p><a id="goland-run-go-processor"></a></p>
</section>
<section id="running-the-processor-go">
<h3>Running the processor (Go)<a class="headerlink" href="#running-the-processor-go" title="Permalink to this heading">¶</a></h3>
<p>Under normal circumstances, the function provided by the user is compiled as a Go plugin that's loaded by the processor.
If you need to debug this plugin loading mechanism, you're advanced enough to find your way around. If all you want to
do is test a new feature on the processor, the easiest way to achieve this is to use Go with the built-in
handler (<code class="docutils literal notranslate"><span class="pre">nuclio:builtin</span></code>). When you specify <code class="docutils literal notranslate"><span class="pre">handler:</span> <span class="pre">nuclio:builtin</span></code> in the processor configuration file, the Go
runtime doesn't try to load a plugin and simply uses <code class="docutils literal notranslate"><span class="pre">pkg/processor/runtime/golang/runtime.go:builtInHandler()</span></code>. Feel
free to modify that function, just don't check in your changes.</p>
<p>The processor configuration file is basically the content of your <strong>function.yaml</strong> function-configuration file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">runtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">golang</span>
<span class="w">  </span><span class="nt">handler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nuclio:builtin</span>
<span class="w">  </span><span class="nt">logger</span><span class="p">:</span>
<span class="w">    </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">debug</span>
<span class="w">  </span><span class="nt">triggers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"> </span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Another configuration that should be given to the processor is the platform configuration, which looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">logger</span><span class="p">:</span>
<span class="w">  </span><span class="nt">sinks</span><span class="p">:</span>
<span class="w">    </span><span class="nt">myStdoutLoggerSink</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stdout</span>
<span class="w">  </span><span class="nt">system</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">debug</span>
<span class="w">      </span><span class="nt">sink</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myStdoutLoggerSink</span>
<span class="w">  </span><span class="nt">functions</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">debug</span>
<span class="w">      </span><span class="nt">sink</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myStdoutLoggerSink</span>
</pre></div>
</div>
<p>Create these two configuration files in your preferred location, and pass <code class="docutils literal notranslate"><span class="pre">--config</span> <span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">processor.yaml&gt;</span> <span class="pre">--platform-config</span> <span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">platform-config.yaml</span></code> as <code class="docutils literal notranslate"><span class="pre">Program</span> <span class="pre">arguments</span></code> in the Run/Debug configuration.</p>
<p>For more information about the platform configuration,
see <span class="xref myst">Configuring a Platform</span>. For information about the
function configuration, see
the <span class="xref myst">Function-Configuration Reference</span>.</p>
<p><a id="goland-run-cli"></a></p>
</section>
<section id="running-the-nuclio-cli-nuctl">
<h3>Running the Nuclio CLI (nuctl)<a class="headerlink" href="#running-the-nuclio-cli-nuctl" title="Permalink to this heading">¶</a></h3>
<p>There's nothing special required to run <code class="docutils literal notranslate"><span class="pre">nuctl</span></code>, but you may want to pass <code class="docutils literal notranslate"><span class="pre">--platform</span> <span class="pre">local</span></code> in case you don't want to
work with Kubernetes.</p>
<p><a id="submitting-a-pr"></a></p>
</section>
</section>
<section id="submitting-a-pr">
<h2>Submitting a PR<a class="headerlink" href="#submitting-a-pr" title="Permalink to this heading">¶</a></h2>
<p>Your PRs will go through Github Action CI and code review. Make sure to follow
the <a class="reference internal" href="coding-conventions.html"><span class="doc std std-doc">coding conventions</span></a> and run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">fmt</span> <span class="pre">lint</span></code> before submitting a PR, that would
save you some time failing on CI linting and test validations</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">nuclio</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/architecture.html">Architecture</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, nuclio.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/devel/contributing.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>